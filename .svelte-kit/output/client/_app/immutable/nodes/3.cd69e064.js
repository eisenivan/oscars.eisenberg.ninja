import{S as W,i as X,s as Z,a as I,e as y,t as V,m as x,f as b,g as L,c as R,b as w,d as C,o as p,h as N,j as k,p as J,u as K,n as T,l as U,q as $,k as M,r as Q}from"../chunks/index.e3f5fe78.js";import{as as ee,at as P,au as S,av as Y,aw as te,ax as se,ay as le}from"../chunks/navigation.54cc5851.js";import{p as ae}from"../chunks/stores.065d49fe.js";import{k as oe,i as j}from"../chunks/helpers.d40725a1.js";import{Y as re}from"../chunks/constants.d3c68800.js";function F(g,t,e){const s=g.slice();return s[8]=t[e],s}function H(g,t,e){const s=g.slice();s[11]=t[e];const r=`${s[8].id}__${oe(s[11].text)}`;return s[12]=r,s}function O(g){let t,e=g[11].subtext+"",s;return{c(){t=y("span"),s=V(e),this.h()},l(r){t=R(r,"SPAN",{class:!0});var c=w(t);s=C(c,e),c.forEach(b),this.h()},h(){p(t,"class","block ml-6 pb-2 font-thin text-xs italic")},m(r,c){N(r,t,c),k(t,s)},p(r,c){c&2&&e!==(e=r[11].subtext+"")&&M(s,e)},d(r){r&&b(t)}}}function z(g,t){let e,s,r,c,m,i,v,h,u=t[11].text+"",_,o,a,f,E,l=t[11].subtext&&O(t);return{key:g,first:null,c(){e=y("label"),s=y("input"),v=I(),h=y("span"),_=V(u),o=I(),l&&l.c(),this.h()},l(d){e=R(d,"LABEL",{class:!0,for:!0});var n=w(e);s=R(n,"INPUT",{class:!0,type:!0,name:!0,id:!0}),v=L(n),h=R(n,"SPAN",{class:!0});var A=w(h);_=C(A,u),A.forEach(b),o=L(n),l&&l.l(n),n.forEach(b),this.h()},h(){s.checked=r=j(t[2],t[12]),p(s,"class","mr-2"),p(s,"type","radio"),p(s,"name",c=t[8].id),s.value=m=t[12],p(s,"id",i=t[12]),p(h,"class",""),p(e,"class","border-solid block pl-2 ml-2 border-l"),p(e,"for",a=t[12]),this.first=e},m(d,n){N(d,e,n),k(e,s),k(e,v),k(e,h),k(h,_),k(e,o),l&&l.m(e,null),f||(E=J(s,"change",t[4]),f=!0)},p(d,n){t=d,n&6&&r!==(r=j(t[2],t[12]))&&(s.checked=r),n&2&&c!==(c=t[8].id)&&p(s,"name",c),n&2&&m!==(m=t[12])&&(s.value=m),n&2&&i!==(i=t[12])&&p(s,"id",i),n&2&&u!==(u=t[11].text+"")&&M(_,u),t[11].subtext?l?l.p(t,n):(l=O(t),l.c(),l.m(e,null)):l&&(l.d(1),l=null),n&2&&a!==(a=t[12])&&p(e,"for",a)},d(d){d&&b(e),l&&l.d(),f=!1,E()}}}function G(g,t){let e,s,r=t[8].name+"",c,m,i=[],v=new Map,h,u=t[8].candidates;const _=o=>o[11].text;for(let o=0;o<u.length;o+=1){let a=H(t,u,o),f=_(a);v.set(f,i[o]=z(f,a))}return{key:g,first:null,c(){e=y("div"),s=y("h2"),c=V(r),m=I();for(let o=0;o<i.length;o+=1)i[o].c();h=I(),this.h()},l(o){e=R(o,"DIV",{class:!0});var a=w(e);s=R(a,"H2",{class:!0});var f=w(s);c=C(f,r),f.forEach(b),m=L(a);for(let E=0;E<i.length;E+=1)i[E].l(a);h=L(a),a.forEach(b),this.h()},h(){p(s,"class","text-xl lg:text-2xl mb-2"),p(e,"class","mb-6"),this.first=e},m(o,a){N(o,e,a),k(e,s),k(s,c),k(e,m);for(let f=0;f<i.length;f+=1)i[f]&&i[f].m(e,null);k(e,h)},p(o,a){t=o,a&2&&r!==(r=t[8].name+"")&&M(c,r),a&22&&(u=t[8].candidates,i=K(i,a,_,1,t,u,v,e,Q,z,h,H))},d(o){o&&b(e);for(let a=0;a<i.length;a+=1)i[a].d()}}}function ne(g){let t,e,s,r,c,m,i,v,h,u=[],_=new Map,o,a,f=g[1];const E=l=>l[8].id;for(let l=0;l<f.length;l+=1){let d=F(g,f,l),n=E(d);_.set(n,u[l]=G(n,d))}return{c(){t=I(),e=y("div"),s=y("label"),r=y("input"),c=I(),m=y("span"),i=V("Close voting"),v=I(),h=y("div");for(let l=0;l<u.length;l+=1)u[l].c();this.h()},l(l){x("svelte-13s6o7t",document.head).forEach(b),t=L(l),e=R(l,"DIV",{});var n=w(e);s=R(n,"LABEL",{class:!0,for:!0});var A=w(s);r=R(A,"INPUT",{class:!0,type:!0,id:!0}),c=L(A),m=R(A,"SPAN",{class:!0});var q=w(m);i=C(q,"Close voting"),q.forEach(b),A.forEach(b),v=L(n),h=R(n,"DIV",{class:!0});var B=w(h);for(let D=0;D<u.length;D+=1)u[D].l(B);B.forEach(b),n.forEach(b),this.h()},h(){document.title="Admin",p(r,"class","mr-2"),p(r,"type","checkbox"),r.checked=g[0],p(r,"id","locked"),p(m,"class",""),p(s,"class","border-solid block pl-2 mb-6"),p(s,"for","locked"),p(h,"class","grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3")},m(l,d){N(l,t,d),N(l,e,d),k(e,s),k(s,r),k(s,c),k(s,m),k(m,i),k(e,v),k(e,h);for(let n=0;n<u.length;n+=1)u[n]&&u[n].m(h,null);o||(a=J(r,"change",g[3]),o=!0)},p(l,[d]){d&1&&(r.checked=l[0]),d&22&&(f=l[1],u=K(u,d,E,1,l,f,_,h,Q,G,null,F))},i:T,o:T,d(l){l&&b(t),l&&b(e);for(let d=0;d<u.length;d+=1)u[d].d();o=!1,a()}}}function ce(g,t,e){let s,r;U(g,ae,_=>e(6,s=_)),U(g,te,_=>e(7,r=_));let c="",m=!0,i=[],v=[];return $(async()=>{if(!r){await ee("/login");return}c=s.params.id;try{const o=P(S,`/groups/${re}`),a=await se(o);e(1,i=a.val()||[])}catch(o){console.error("Error loading categories:",o)}const _=P(S,`/settings/${c}`);le(_,o=>{const a=o.val();a&&(e(0,m=a.locked||!1),e(2,v=a.results||[]))})}),[m,i,v,async _=>{const o=_.target.checked;try{const a=P(S,`settings/${c}/locked`);await Y(a,!!o),e(0,m=o)}catch(a){console.error("Error updating locked status:",a)}},async _=>{const o=_.target.value,a=[...v],f=o.split("__")[0],E=a.findIndex(l=>l.indexOf(f)>-1);E===-1?a.push(o):a[E]=o;try{const l=P(S,`settings/${c}/results`);await Y(l,a),e(2,v=a)}catch(l){console.error("Error updating results:",l)}}]}class _e extends W{constructor(t){super(),X(this,t,ce,ne,Z,{})}}export{_e as component};
