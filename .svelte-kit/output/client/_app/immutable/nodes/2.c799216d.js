import{S as ee,i as te,s as le,a as I,D as V,E as se,g as v,h as M,k as O,n as j,F as ae,t as H,p as oe,G as ne,H as re,e as y,c as K,b as E,d as N,f as Q,j as k,m as W,l as b,I as X,J as Z,o as x,C as ie,q as S,r as w,x as B,v as ce}from"../chunks/index.d983bbc4.js";import{g as fe}from"../chunks/navigation.e0bfb279.js";import{as as ue,av as R,aw as D,ax as z,ay as _e,az as de}from"../chunks/auth.4dcf20aa.js";import{k as he,i as C}from"../chunks/helpers.d40725a1.js";import{Y as L}from"../chunks/constants.0cc9b3e7.js";import{L as pe}from"../chunks/Loader.1d641830.js";import{P as me}from"../chunks/PageHeading.2f32458f.js";async function ge(){return{}}const Me=Object.freeze(Object.defineProperty({__proto__:null,load:ge},Symbol.toStringTag,{value:"Module"}));function F(_,t,l){const e=_.slice();e[9]=t[l];const s=e[1].find(function(...c){return _[7](e[9],...c)});e[10]=s;const a=e[0].indexOf(e[10])>-1;e[11]=a;const m=e[3]&&e[1].length>0&&e[10]&&e[11]?"text-green-600":e[3]&&e[1].length>0&&e[10]&&!e[11]?"text-red-600":"";e[12]=m;const n=e[3]&&e[1].length>0&&e[10]&&e[11]?"✓":e[3]&&e[1].length>0&&e[10]&&!e[11]?"✕":"";return e[13]=n,e}function T(_,t,l){const e=_.slice();e[16]=t[l];const s=`${e[9].id}__${he(e[16].text)}`;return e[17]=s,e}function be(_){let t,l,e,s,a=[],m=new Map,n;l=new me({props:{$$slots:{default:[ke]},$$scope:{ctx:_}}});let u=_[2];const c=o=>o[9].id;for(let o=0;o<u.length;o+=1){let f=F(_,u,o),i=c(f);m.set(i,a[o]=U(i,f))}return{c(){t=y("div"),K(l.$$.fragment),e=I(),s=y("div");for(let o=0;o<a.length;o+=1)a[o].c();this.h()},l(o){t=E(o,"DIV",{});var f=N(t);Q(l.$$.fragment,f),e=M(f),s=E(f,"DIV",{class:!0});var i=N(s);for(let p=0;p<a.length;p+=1)a[p].l(i);i.forEach(v),f.forEach(v),this.h()},h(){k(s,"class","mt-8 grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 border-blue-700 border-8 rounded-sm border-opacity-10 shadow-sm p-4 bg-blue-100")},m(o,f){O(o,t,f),W(l,t,null),b(t,e),b(t,s);for(let i=0;i<a.length;i+=1)a[i]&&a[i].m(s,null);n=!0},p(o,f){const i={};f&1048618&&(i.$$scope={dirty:f,ctx:o}),l.$set(i),f&79&&(u=o[2],a=X(a,f,c,1,o,u,m,s,Z,U,null,F))},i(o){n||(H(l.$$.fragment,o),n=!0)},o(o){j(l.$$.fragment,o),n=!1},d(o){o&&v(t),x(l);for(let f=0;f<a.length;f+=1)a[f].d()}}}function ve(_){let t,l;return t=new pe({}),{c(){K(t.$$.fragment)},l(e){Q(t.$$.fragment,e)},m(e,s){W(t,e,s),l=!0},p:ie,i(e){l||(H(t.$$.fragment,e),l=!0)},o(e){j(t.$$.fragment,e),l=!1},d(e){x(t,e)}}}function Y(_){let t,l,e,s,a=_[1].length+"",m;return{c(){t=y("span"),l=S("Score: "),e=S(_[5]),s=S("/"),m=S(a),this.h()},l(n){t=E(n,"SPAN",{class:!0});var u=N(t);l=w(u,"Score: "),e=w(u,_[5]),s=w(u,"/"),m=w(u,a),u.forEach(v),this.h()},h(){k(t,"class","ml-2 text-sm")},m(n,u){O(n,t,u),b(t,l),b(t,e),b(t,s),b(t,m)},p(n,u){u&32&&B(e,n[5]),u&2&&a!==(a=n[1].length+"")&&B(m,a)},d(n){n&&v(t)}}}function ke(_){let t,l,e=_[3]&&_[1].length>0&&Y(_);return{c(){t=S(`My Ballot
			`),e&&e.c(),l=V()},l(s){t=w(s,`My Ballot
			`),e&&e.l(s),l=V()},m(s,a){O(s,t,a),e&&e.m(s,a),O(s,l,a)},p(s,a){s[3]&&s[1].length>0?e?e.p(s,a):(e=Y(s),e.c(),e.m(l.parentNode,l)):e&&(e.d(1),e=null)},d(s){s&&v(t),e&&e.d(s),s&&v(l)}}}function G(_){let t,l=_[16].subtext+"",e;return{c(){t=y("span"),e=S(l),this.h()},l(s){t=E(s,"SPAN",{class:!0});var a=N(t);e=w(a,l),a.forEach(v),this.h()},h(){k(t,"class","block ml-6 pb-2 font-light text-xs italic")},m(s,a){O(s,t,a),b(t,e)},p(s,a){a&4&&l!==(l=s[16].subtext+"")&&B(e,l)},d(s){s&&v(t)}}}function J(_,t){let l,e,s,a,m,n,u,c,o=t[16].text+"",f,i,p,g,$,P,r=t[16].subtext&&G(t);return{key:_,first:null,c(){l=y("label"),e=y("input"),u=I(),c=y("span"),f=S(o),i=I(),r&&r.c(),this.h()},l(h){l=E(h,"LABEL",{class:!0,for:!0});var d=N(l);e=E(d,"INPUT",{class:!0,type:!0,name:!0,id:!0}),u=M(d),c=E(d,"SPAN",{class:!0});var A=N(c);f=w(A,o),A.forEach(v),i=M(d),r&&r.l(d),d.forEach(v),this.h()},h(){e.disabled=t[3],e.checked=s=C(t[0],t[17]),k(e,"class","mr-2"),k(e,"type","radio"),k(e,"name",a=t[9].id),e.value=m=t[17],k(e,"id",n=t[17]),k(c,"class","uppercase"),k(l,"class",p=`border-solid block pl-2 ml-2 border-l border-indigo-200 ${t[1].indexOf(t[17])>-1?t[12]:""}`),k(l,"for",g=t[17]),this.first=l},m(h,d){O(h,l,d),b(l,e),b(l,u),b(l,c),b(c,f),b(l,i),r&&r.m(l,null),$||(P=ce(e,"change",t[6]),$=!0)},p(h,d){t=h,d&8&&(e.disabled=t[3]),d&5&&s!==(s=C(t[0],t[17]))&&(e.checked=s),d&4&&a!==(a=t[9].id)&&k(e,"name",a),d&4&&m!==(m=t[17])&&(e.value=m),d&4&&n!==(n=t[17])&&k(e,"id",n),d&4&&o!==(o=t[16].text+"")&&B(f,o),t[16].subtext?r?r.p(t,d):(r=G(t),r.c(),r.m(l,null)):r&&(r.d(1),r=null),d&15&&p!==(p=`border-solid block pl-2 ml-2 border-l border-indigo-200 ${t[1].indexOf(t[17])>-1?t[12]:""}`)&&k(l,"class",p),d&4&&g!==(g=t[17])&&k(l,"for",g)},d(h){h&&v(l),r&&r.d(),$=!1,P()}}}function U(_,t){let l,e,s=t[9].name+"",a,m,n,u=t[13]+"",c,o,f,i=[],p=new Map,g,$=t[9].candidates;const P=r=>r[16].text;for(let r=0;r<$.length;r+=1){let h=T(t,$,r),d=P(h);p.set(d,i[r]=J(d,h))}return{key:_,first:null,c(){l=y("div"),e=y("h2"),a=S(s),m=I(),n=y("i"),c=S(u),f=I();for(let r=0;r<i.length;r+=1)i[r].c();g=I(),this.h()},l(r){l=E(r,"DIV",{class:!0});var h=N(l);e=E(h,"H2",{class:!0});var d=N(e);a=w(d,s),m=M(d),n=E(d,"I",{class:!0});var A=N(n);c=w(A,u),A.forEach(v),d.forEach(v),f=M(h);for(let q=0;q<i.length;q+=1)i[q].l(h);g=M(h),h.forEach(v),this.h()},h(){k(n,"class",o=t[12]),k(e,"class","text-md font-semibold mb-2 uppercase"),k(l,"class","mb-6"),this.first=l},m(r,h){O(r,l,h),b(l,e),b(e,a),b(e,m),b(e,n),b(n,c),b(l,f);for(let d=0;d<i.length;d+=1)i[d]&&i[d].m(l,null);b(l,g)},p(r,h){t=r,h&4&&s!==(s=t[9].name+"")&&B(a,s),h&15&&u!==(u=t[13]+"")&&B(c,u),h&15&&o!==(o=t[12])&&k(n,"class",o),h&79&&($=t[9].candidates,i=X(i,h,P,1,t,$,p,l,Z,J,g,T))},d(r){r&&v(l);for(let h=0;h<i.length;h+=1)i[h].d()}}}function $e(_){let t,l,e,s,a;const m=[ve,be],n=[];function u(c,o){return c[4]?0:1}return l=u(_),e=n[l]=m[l](_),{c(){t=I(),e.c(),s=V(),this.h()},l(c){se("svelte-1pmvvdc",document.head).forEach(v),t=M(c),e.l(c),s=V(),this.h()},h(){document.title="My Ballot"},m(c,o){O(c,t,o),n[l].m(c,o),O(c,s,o),a=!0},p(c,[o]){let f=l;l=u(c),l===f?n[l].p(c,o):(re(),j(n[f],1,1,()=>{n[f]=null}),ae(),e=n[l],e?e.p(c,o):(e=n[l]=m[l](c),e.c()),H(e,1),e.m(s.parentNode,s))},i(c){a||(H(e),a=!0)},o(c){j(e),a=!1},d(c){c&&v(t),n[l].d(c),c&&v(s)}}}function ye(_,t,l){let e;oe(_,ue,i=>l(8,e=i));let s=[],a=[],m=!1,n=[],u=!0;ne(async()=>{if(!e){await fe("/login");return}try{const p=R(D,`/groups/${L}`),g=await z(p);l(2,s=g.val()||[]),l(4,u=!1)}catch(p){console.error("Error loading categories:",p)}const i=R(D,`/settings/${L}`);_e(i,p=>{const g=p.val();g&&(l(3,m=g.locked||!1),l(1,n=g.results||[]))});try{const p=R(D,`/ballots/${L}/${e.uid}/votes`),g=await z(p);l(0,a=g.val()||[])}catch(p){console.error("Error loading ballot:",p)}});const c=async i=>{const p=i.target.value,g=[...a],$=p.split("__")[0],P=g.findIndex(r=>r.indexOf($)>-1);P===-1?g.push(p):g[P]=p;try{const r=R(D,`ballots/${L}/${e.uid}`);await de(r,{displayName:e.displayName,votes:g}),l(0,a=g)}catch(r){console.error("Error updating ballot:",r)}};let o=0;const f=(i,p)=>p.indexOf(i.id)>-1;return _.$$.update=()=>{_.$$.dirty&35&&a.length>0&&n.length>0&&(l(5,o=0),n.forEach(i=>{a.indexOf(i)>-1&&l(5,o+=1)}))},[a,n,s,m,u,o,c,f]}class Be extends ee{constructor(t){super(),te(this,t,ye,$e,le,{})}}export{Be as component,Me as universal};
